import{r as T,j as a}from"./index-C62ueu57.js";import{S as $,r as z}from"./transform-BGpuWWbS.js";import{a as S,b as F,u as C}from"./react-erZmAGyW.js";import{l as Z,t as Q,a as q,e as J}from"./line-DBlvyd-F.js";import{f as V,l as X,m as K}from"./linear-BwuSL8oF.js";import"./path-CbwjOpE9.js";function tt(t){return typeof t=="string"?new $([[document.querySelector(t)]],[document.documentElement]):new $([[t]],z)}var O={},D={},R=34,w=10,L=13;function W(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function et(t,e){var n=W(t);return function(r,s){return e(n(r),s,t)}}function U(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var s in r)s in e||n.push(e[s]=s)}),n}function j(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function nt(t){return t<0?"-"+j(-t,6):t>9999?"+"+j(t,6):j(t,4)}function st(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),s=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":nt(t.getUTCFullYear())+"-"+j(t.getUTCMonth()+1,2)+"-"+j(t.getUTCDate(),2)+(s?"T"+j(e,2)+":"+j(n,2)+":"+j(r,2)+"."+j(s,3)+"Z":r?"T"+j(e,2)+":"+j(n,2)+":"+j(r,2)+"Z":n||e?"T"+j(e,2)+":"+j(n,2)+"Z":"")}function rt(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(o,c){var y,x,u=s(o,function(m,f){if(y)return y(m,f-1);x=m,y=c?et(m,c):W(m)});return u.columns=x||[],u}function s(o,c){var y=[],x=o.length,u=0,m=0,f,v=x<=0,b=!1;o.charCodeAt(x-1)===w&&--x,o.charCodeAt(x-1)===L&&--x;function E(){if(v)return D;if(b)return b=!1,O;var k,N=u,_;if(o.charCodeAt(N)===R){for(;u++<x&&o.charCodeAt(u)!==R||o.charCodeAt(++u)===R;);return(k=u)>=x?v=!0:(_=o.charCodeAt(u++))===w?b=!0:_===L&&(b=!0,o.charCodeAt(u)===w&&++u),o.slice(N+1,k-1).replace(/""/g,'"')}for(;u<x;){if((_=o.charCodeAt(k=u++))===w)b=!0;else if(_===L)b=!0,o.charCodeAt(u)===w&&++u;else if(_!==n)continue;return o.slice(N,k)}return v=!0,o.slice(N,x)}for(;(f=E())!==D;){for(var A=[];f!==O&&f!==D;)A.push(f),f=E();c&&(A=c(A,m++))==null||y.push(A)}return y}function i(o,c){return o.map(function(y){return c.map(function(x){return p(y[x])}).join(t)})}function l(o,c){return c==null&&(c=U(o)),[c.map(p).join(t)].concat(i(o,c)).join(`
`)}function g(o,c){return c==null&&(c=U(o)),i(o,c).join(`
`)}function d(o){return o.map(h).join(`
`)}function h(o){return o.map(p).join(t)}function p(o){return o==null?"":o instanceof Date?st(o):e.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:r,parseRows:s,format:l,formatBody:g,formatRows:d,formatRow:h,formatValue:p}}var ot=rt(","),at=ot.parse;function it(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function ct(t,e){return fetch(t,e).then(it)}function lt(t){return function(e,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),ct(e,n).then(function(s){return t(s,r)})}}var ut=lt(at);function B(t){this._context=t}B.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=H(t),s=H(e),i=0,l=1;l<n;++i,++l)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],t[l],e[l]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function H(t){var e,n=t.length-1,r,s=new Array(n),i=new Array(n),l=new Array(n);for(s[0]=0,i[0]=2,l[0]=t[0]+2*t[1],e=1;e<n-1;++e)s[e]=1,i[e]=4,l[e]=4*t[e]+2*t[e+1];for(s[n-1]=2,i[n-1]=7,l[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=s[e]/i[e-1],i[e]-=r,l[e]-=r*l[e-1];for(s[n-1]=l[n-1]/i[n-1],e=n-2;e>=0;--e)s[e]=(l[e]-s[e+1])/i[e];for(i[n-1]=(t[n]+s[n-1])/2,e=0;e<n-1;++e)i[e]=2*t[e+1]-s[e+1];return[s,i]}function ft(t){return new B(t)}const ht=S(null),P=S(0),Y=S(!1),I=S(!1),mt="/data/Federal Employment Data.csv",dt=()=>{const[t,e]=F(ht);return T.useEffect(()=>{ut(mt,r=>({...r,timestamp:new Date(r.Month),TotalNonFarm:+r.TotalNonFarm*1e3,Federal:+r.Federal*1e3})).then(r=>{e(r)})},[e]),console.log(t),t},xt=({xScale:t,innerHeight:e,tickFormat:n,tickOffset:r=3})=>t.ticks().map(s=>a.jsxs("g",{className:"tick no-select",transform:`translate(${t(s)},0)`,children:[a.jsx("line",{y2:e}),a.jsx("text",{style:{textAnchor:"middle"},dy:".71em",y:e+r,children:n(s)})]},s)),gt=({yScale:t,innerWidth:e,tickFormat:n,tickOffset:r=3})=>t.ticks().map(s=>a.jsxs("g",{className:"tick no-select",transform:`translate(0,${t(s)})`,children:[a.jsx("line",{x2:e}),a.jsx("text",{style:{textAnchor:"end"},x:-r,dy:".32em",children:n(s)},s)]})),pt=({data:t,xScale:e,yScale:n,xValue:r,yValue:s,tooltipFormat:i,circleRadius:l})=>{const g=T.useRef(),d=Z().x(h=>e(r(h))).y(h=>n(s(h))).curve(ft);return T.useEffect(()=>{if(!g.current)return;const h=tt(g.current),p=h.node().getTotalLength();return h.attr("stroke-dasharray",p).attr("stroke-dashoffset",p),h.transition().duration(2e3).attr("stroke-dashoffset",0),()=>{h.interrupt()}},[t,e,n,r,s,l]),a.jsx("g",{className:"marks",children:a.jsx("path",{ref:g,fill:"none",stroke:"black",strokeWidth:"4",d:d(t)})})},yt=({children:t,width:e,height:n,centerX:r,centerY:s,isDraggable:i})=>a.jsx("svg",{width:e,height:n,children:a.jsx("g",{transform:`translate(${r}, ${s})`,children:t})}),M=({x1:t,y1:e,x2:n,y2:r,x3:s,y3:i,id:l})=>{const[g,d]=T.useState(!1),[h,p]=T.useState(.2),[o,c]=F(Y),y=C(I),[x,u]=F(P),m=`${t},${e} ${n},${r} ${s},${i}`;T.useEffect(()=>{if(!o){const E=setInterval(()=>{p(A=>A===.2?.4:.2)},750);return()=>clearInterval(E)}},[o]);const f=()=>{d(!0)},v=()=>{u(l),console.log("Guess:",l),c(!0)},b=()=>g||l===x?.6:o?y?0:.2:h;return a.jsx("polygon",{className:l,points:m,fill:"green",opacity:b(),stroke:"white",strokeWidth:"1.5",onMouseEnter:y?null:f,onMouseLeave:()=>d(!1),onClick:y?null:v,style:{cursor:"pointer",pointerEvents:"all",transition:"opacity .75s ease"}})},jt=()=>{const t=C(P);return a.jsxs("h2",{children:["Since 1960, US Federal Employment as a % of the Labor Force has been"," ",a.jsx("span",{style:{color:"green",textDecoration:"underline"},children:t||"____________"}),"?"]})},vt=()=>{const[t,e]=F(I),n=C(Y),s=n?t?"submitted":"ready":"idle",i={idle:{text:"Select a region below first.",className:"",onClick:()=>{}},ready:{text:"Click to submit guess!",className:"pulse-element",onClick:()=>e(!0)},submitted:{text:"Guess submitted!",className:"",onClick:()=>{}}};return a.jsx("div",{children:s!=="submitted"&&a.jsx("button",{className:i[s].className,onClick:i[s].onClick,children:i[s].text})})},bt=()=>{const e=C(P)==="Generally Decreasing"?"That's right! ":"I too was surprised to learn that:";return a.jsxs(a.Fragment,{children:[a.jsx("h2",{children:e}),a.jsx("h2",{children:"Since the 1960s, the number of federal employees has been declining relative to overall employment."}),a.jsxs("p",{children:[" ","The source of this data is the US Bureau of Labor Statistics as served by FRED:"]}),a.jsx("p",{children:a.jsx("a",{href:"https://fred.stlouisfed.org/series/PAYEMS",target:"_blank",children:"Total Nonfarm Payroll Employment"})}),a.jsx("p",{children:a.jsx("a",{href:"https://fred.stlouisfed.org/series/CES9091000001",target:"_blank",children:"Total Federal Payroll Employment"})})]})},Tt=()=>{const[t,e]=T.useState({width:960,height:500});return T.useEffect(()=>{const n=()=>{const s=window.innerWidth-40,i=window.innerHeight*.6,l=960,g=500,d=300,h=Math.min(s,l),p=Math.max(Math.min(i,g),d);e({width:h,height:p})};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),t},At=t=>{const e=t<768;return{top:20,right:e?20:30,bottom:e?50:65,left:e?60:90}},G=252,Ft=()=>{const t=dt(),e=C(I),{width:n,height:r}=Tt(),s=At(n),i=n<768?40:50,l=n<768?35:45;if(!t)return a.jsx("pre",{children:"Data is Loading..."});const g=r-s.top-s.bottom,d=n-s.left-s.right,h=v=>v.timestamp,p=Q("%Y"),o="Time",c=v=>v.Federal/v.TotalNonFarm,y=V(".0%"),x="Percent",u=q().domain(J(t,h)).range([0,d]).nice(),m=X().domain([0,(K(t,c)||0)+.01]).range([g,0]).nice(),f=t[G-1];return a.jsxs("div",{className:"container",children:[a.jsx(jt,{}),a.jsxs(yt,{width:n,height:r,centerX:s.left,centerY:s.top,isDraggable:!0,children:[a.jsx(xt,{xScale:u,innerHeight:g,tickFormat:p,tickOffset:7}),a.jsx("text",{className:"axis-label no-select",textAnchor:"middle",transform:`translate(${-l},${g/2}) rotate(-90)`,children:x}),a.jsx(gt,{yScale:m,innerWidth:d,tickFormat:y,tickOffset:7}),a.jsx("text",{className:"axis-label no-select",x:d/2,y:g+i,textAnchor:"middle",children:o}),a.jsx(pt,{data:e?t:t.slice(0,G),xScale:u,yScale:m,xValue:h,yValue:c,tooltipFormat:p,circleRadius:3}),a.jsx(M,{x1:u(h(f)),y1:m(c(f)),x2:d,y2:m(c(f)+.015),x3:d,y3:m(c(f)-.015),id:"Generally Flat"}),a.jsx(M,{x1:u(h(f)),y1:m(c(f)),x2:d,y2:m(c(f)-.015),x3:d,y3:m(c(f)-3*.015),id:"Generally Decreasing"}),a.jsx(M,{x1:u(h(f)),y1:m(c(f)),x2:d,y2:m(c(f)+3*.015),x3:d,y3:m(c(f)+.015),id:"Generally Increasing"})]}),e?a.jsx(bt,{}):a.jsx(vt,{})]})};export{Ft as default};
